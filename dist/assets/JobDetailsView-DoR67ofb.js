import{d as h,i as w,r as c,o as D,c as l,a as s,b as M,t as a,u as p,n as S,j as m,f as B,g as N,k,h as u,_ as V}from"./main-SXArKNhp.js";import{u as j}from"./customers-CLKtf8wD.js";const x={class:"job-details-container"},I={key:0,class:"loading-state"},R={key:1,class:"error-state"},T={key:2,class:"job-details"},A={class:"job-header"},F={class:"event-meta"},J={class:"meta-item"},z={class:"meta-item"},L={class:"meta-item"},P={key:0,class:"customer-details"},q={class:"customer-info"},G={class:"info-item"},H={class:"info-item"},K={class:"info-item"},O={class:"info-item"},Q={key:1,class:"notes-section"},U={class:"action-buttons"},W={key:3,class:"not-found"},X=h({__name:"JobDetailsView",setup(Y){const C=B(),v=N(),b=w(),_=j(),e=c(null),i=c(null),r=c(!0),d=c(null);function E(n){return k(new Date(n),"EEEE, MMMM d, yyyy")}function g(n){return k(new Date(`2000-01-01T${n}`),"h:mm a")}function $(n){const t=Math.floor(n/60),o=n%60;return t===0?`${n} minutes`:o>0?`${t}h ${o}m`:`${t} hour${t>1?"s":""}`}async function y(n){var t;if((t=e.value)!=null&&t.id)try{r.value=!0,await b.updateEventStatus(e.value.id,n),await f()}catch(o){d.value=o instanceof Error?o.message:"Failed to update status"}finally{r.value=!1}}async function f(){const n=C.params.id;if(!n){v.push("/");return}r.value=!0,d.value=null;try{const t=await b.getEvent(n);if(!t)throw new Error("Event not found");e.value=t,t.customerId&&(i.value=await _.getCustomer(t.customerId))}catch(t){console.error("Error loading event:",t),d.value=t instanceof Error?t.message:"Failed to load event"}finally{r.value=!1}}return D(f),(n,t)=>(u(),l("div",x,[r.value?(u(),l("div",I,t[5]||(t[5]=[s("div",{class:"spinner"},null,-1),M(" Loading... ")]))):d.value?(u(),l("div",R,[s("p",null,a(d.value),1),s("button",{onClick:f,class:"btn btn-primary"},"Retry"),s("button",{onClick:t[0]||(t[0]=o=>p(v).push("/")),class:"btn btn-secondary"},"Back to Calendar")])):e.value?(u(),l("div",T,[s("div",A,[s("h1",null,a(e.value.title),1),s("div",{class:S(["status-badge",e.value.status])},a(e.value.status),3)]),s("div",F,[s("div",J,[t[6]||(t[6]=s("i",{class:"fas fa-calendar"},null,-1)),s("span",null,a(E(e.value.date)),1)]),s("div",z,[t[7]||(t[7]=s("i",{class:"fas fa-clock"},null,-1)),s("span",null,a(g(e.value.time)),1)]),s("div",L,[t[8]||(t[8]=s("i",{class:"fas fa-hourglass-half"},null,-1)),s("span",null,a($(e.value.duration)),1)])]),i.value?(u(),l("div",P,[t[13]||(t[13]=s("h2",null,"Customer Details",-1)),s("div",q,[s("div",G,[t[9]||(t[9]=s("label",null,"Name:",-1)),s("span",null,a(i.value.name),1)]),s("div",H,[t[10]||(t[10]=s("label",null,"Phone:",-1)),s("span",null,a(i.value.phone),1)]),s("div",K,[t[11]||(t[11]=s("label",null,"Email:",-1)),s("span",null,a(i.value.email),1)]),s("div",O,[t[12]||(t[12]=s("label",null,"Address:",-1)),s("span",null,a(i.value.address),1)])])])):m("",!0),e.value.notes?(u(),l("div",Q,[t[14]||(t[14]=s("h2",null,"Notes",-1)),s("p",null,a(e.value.notes),1)])):m("",!0),s("div",U,[e.value.status==="scheduled"?(u(),l("button",{key:0,class:"btn btn-success",onClick:t[1]||(t[1]=o=>y("completed"))}," Mark as Completed ")):m("",!0),e.value.status==="scheduled"?(u(),l("button",{key:1,class:"btn btn-danger",onClick:t[2]||(t[2]=o=>y("cancelled"))}," Cancel Appointment ")):m("",!0),s("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=o=>p(v).push("/"))}," Back to Calendar ")])])):(u(),l("div",W,[t[15]||(t[15]=s("p",null,"Event not found",-1)),s("button",{onClick:t[4]||(t[4]=o=>p(v).push("/")),class:"btn btn-primary"},"Back to Calendar")]))]))}}),st=V(X,[["__scopeId","data-v-166e03b1"]]);export{st as default};
